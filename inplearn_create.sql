CREATE TABLE TBL_CATEGORY(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY,
    NAME VARCHAR2(50) NOT NULL,
    SUPER VARCHAR2(10) 
   );
ALTER TABLE TBL_CATEGORY MODIFY(ID VARCHAR2(50));
ALTER TABLE TBL_CATEGORY MODIFY(SUPER VARCHAR2(50));
ALTER TABLE TBL_CATEGORY ADD  CONSTRAINT FK_CATEGORY_CATEGORY 
FOREIGN KEY(ID) REFERENCES TBL_CATEGORY(ID);

CREATE TABLE TBL_MEMBER(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY,
    NAME VARCHAR2(50) NOT NULL,
    PASSWORD VARCHAR2(50) NOT NULL,
    TEL NUMBER(20) NOT NULL,
    EMAIL VARCHAR2(50) NOT NULL,
    GRADE VARCHAR2(10) DEFAULT 'MEMBER',
    PROFILE VARCHAR(1000),
    CATEGORY VARCHAR2(50),
    CONSTRAINT FK_MEMBER_CATEGORY FOREIGN KEY(CATEGORY) 
     REFERENCES TBL_CATEGORY(ID)
    );
 --------------------------------------------------------ERROR!!!   
CREATE TABLE TBL_COURSE(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY
    ,CATEGORY VARCHAR2(10) NOT NULL
    ,CATEGORY2 VARCHAR2(10) NOT NULL
    ,NAME VARCHAR2(50) NOT NULL
    ,MENTO VARCHAR2(10) NOT NULL
    ,PRICE NUMBER(10) NOT NULL
    ,LEVELTYPE NUMBER(2) DEFAULT 1
    ,DISCOUNT NUMBER(3) DEFAULT 0
    ,CONTENT VARCHAR2(1000) 
    ,IMG VARCHAR2(1000) 
    ,REGDATE DATE DEFAULT SYSDATE
    ,CONSTRAINT FK_COURSE_CATEGORY FOREIGN KEY(CATEGORY) 
     REFERENCES TBL_CATEGORY(ID)
     ,CONSTRAINT FK_COURSE_CATEGORY2 FOREIGN KEY(CATEGORY2) 
     REFERENCES TBL_CATEGORY(ID)
     ,CONSTRAINT FK_COURSE_MEMBER FOREIGN KEY(MENTO)
     REFERENCES TBL_MEMBER(ID)
     ,CONSTRAINT C_LEVEL CHECK (LEVELTYPE BETWEEN 1 AND 3)
     );
 -------------------------------------------------------------
 
ALTER TABLE TBL_COURSE MODIFY(CATEGORY VARCHAR2(50));
ALTER TABLE TBL_COURSE MODIFY(CATEGORY2 VARCHAR2(50));
ALTER TABLE TBL_COURSE MODIFY(CATEGORY2 VARCHAR2(50) NULL);
ALTER TABLE TBL_COURSE MODIFY(NAME VARCHAR2(100));

 CREATE TABLE TBL_REVIEW(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY
    ,M_ID VARCHAR2(10) NOT NULL
    ,C_ID VARCHAR2(10) NOT NULL
    ,DETAIL VARCHAR2(1000) NOT NULL
    ,STAR NUMBER(1) 
    ,WDATE DATE DEFAULT SYSDATE
    ,CONSTRAINT FK_REVIEW_MEMBER FOREIGN KEY(M_ID)
    REFERENCES TBL_MEMBER(ID)
    ,CONSTRAINT FK_REVIEW_COURSE FOREIGN KEY(C_ID)
    REFERENCES TBL_COURSE(ID)
    ,CONSTRAINT C_STAR CHECK (STAR BETWEEN 1 AND 5)
    );
    
CREATE TABLE TBL_CART(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY
    ,C_ID VARCHAR2(10) NOT NULL
    ,M_ID VARCHAR2(10) NOT NULL
    ,PRICE NUMBER(10) 
    ,ADDDATE DATE DEFAULT SYSDATE
    ,CONSTRAINT FK_CART_COURSE FOREIGN KEY(C_ID)
    REFERENCES TBL_COURSE(ID)
    ,CONSTRAINT FK_CART_MEMBER FOREIGN KEY(M_ID)
    REFERENCES TBL_MEMBER(ID)
);

CREATE TABLE TBL_ORDER(
    ID VARCHAR2(10) NOT NULL PRIMARY KEY
    ,C_ID VARCHAR2(10) NOT NULL
    ,M_ID VARCHAR2(10) NOT NULL
    ,PRICE NUMBER(10)
    ,ORDERDATE DATE DEFAULT SYSDATE
    ,CONSTRAINT FK_ORDER_COURSE FOREIGN KEY(C_ID)
    REFERENCES TBL_COURSE(ID)
    ,CONSTRAINT FK_ORDER_MEMBER FOREIGN KEY(M_ID)
    REFERENCES TBL_MEMBER(ID)
    );
    COMMIT;
    CREATE SEQUENCE COURSE_SEQ;
    CREATE SEQUENCE REVIEW_SEQ;
    CREATE SEQUENCE CART_SEQ;
    CREATE SEQUENCE ORDER_SEQ;
    
    ROLLBACK;
    SELECT SEQUENCE_NAME FROM USER_SEQUENCES WHERE SEQUENCE_NAME LIKE '%SEQ';
    
    INSERT INTO TBL_CATEGORY(ID,NAME)
    VALUES('it-programming','개발,프로그래밍');
    INSERT INTO TBL_CATEGORY(ID,NAME)
    VALUES('it','보안, 네트워크');
    INSERT INTO TBL_CATEGORY(ID,NAME)
    VALUES('data-science','데이터 사이언스');
    INSERT INTO TBL_CATEGORY(ID,NAME,SUPER)
    VALUES('web-dev','웹 개발','it-programming');
    INSERT INTO TBL_CATEGORY(ID,NAME,SUPER)
    VALUES('server-dev','서버 개발','it-programming');
    INSERT INTO TBL_CATEGORY(ID,NAME,SUPER)
    VALUES('infra','인프라','it');
    
    INSERT INTO TBL_MEMBER(ID,NAME,PASSWORD,TEL,EMAIL,PROFILE,CATEGORY)
    VALUES('USER1','하하하','1234',01012341234,'이메일@email.com','프로그래밍 러브','it-programming');
    INSERT INTO TBL_MEMBER(ID,NAME,PASSWORD,TEL,EMAIL,PROFILE,CATEGORY)
    VALUES('USER2','코딩왕','1234',01012341234,'이메일@gmail.com','웹개발이 하고파요','it-programming');
    INSERT INTO TBL_MEMBER(ID,NAME,PASSWORD,TEL,EMAIL,PROFILE,CATEGORY)
    VALUES('USER3','코코','1234',01012341234,'이메일@daum.com','데이터 사이언티스트 목표','data-science');
    INSERT INTO TBL_MEMBER(ID,NAME,PASSWORD,TEL,EMAIL,GRADE,PROFILE,CATEGORY)
    VALUES('MENTO1','코딩팩토리','1234',01012341234,'py@daum.com','MENTO','파이썬 전문가','data-science');
    INSERT INTO TBL_MEMBER(ID,NAME,PASSWORD,TEL,EMAIL,GRADE,PROFILE,CATEGORY)
    VALUES('MENTO2','김길동','1234',01012341234,'it@daum.com','MENTO','IT러브','it');
    
    INSERT INTO TBL_COURSE(ID, CATEGORY,NAME,MENTO,PRICE,LEVELTYPE,DISCOUNT,IMG)
    VALUES(COURSE_SEQ.NEXTVAL,'data-science','오라클성능분석과 튜닝가이드','MENTO1',66000,2,0,'IMG.png');
    INSERT INTO TBL_COURSE(ID, CATEGORY,NAME,MENTO,PRICE,LEVELTYPE,DISCOUNT,IMG)
    VALUES(COURSE_SEQ.NEXTVAL,'data-science','공공데이터로 파이썬 데이터 분석','MENTO1',59400,1,0,'IMG2.png');
    INSERT INTO TBL_COURSE(ID, CATEGORY,NAME,MENTO,PRICE,LEVELTYPE,DISCOUNT,IMG)
    VALUES(COURSE_SEQ.NEXTVAL,'it','쉽게 시작하는 쿠버네티스','MENTO2',35000,1,0,'IMG3.png');
    INSERT INTO TBL_COURSE(ID, CATEGORY,NAME,MENTO,PRICE,LEVELTYPE,DISCOUNT,IMG)
    VALUES(COURSE_SEQ.NEXTVAL,'it','리눅스 커맨드라인 툴(Full ver)','MENTO2',55000,1,0,'IMG4.png');
    
    SELECT * FROM TBL_COURSE;
    
    INSERT INTO TBL_REVIEW(ID,M_ID,C_ID,DETAIL,STAR)
    VALUES(REVIEW_SEQ.NEXTVAL,'USER1',7,'재미있어요',5);
    INSERT INTO TBL_REVIEW(ID,M_ID,C_ID,DETAIL,STAR)
    VALUES(REVIEW_SEQ.NEXTVAL,'USER2',7,'이해가 향상되었습니다',4);
    INSERT INTO TBL_REVIEW(ID,M_ID,C_ID,DETAIL,STAR)
    VALUES(REVIEW_SEQ.NEXTVAL,'USER1',2,'알찬 강의 너무 감사합니다.',5);
    
    INSERT INTO TBL_CART(ID,C_ID,M_ID,PRICE)
    VALUES(CART_SEQ.NEXTVAL, 7,'USER1',35000);
    INSERT INTO TBL_CART(ID,C_ID,M_ID,PRICE)
    VALUES(CART_SEQ.NEXTVAL, 7,'USER2',35000);
    INSERT INTO TBL_CART(ID,C_ID,M_ID,PRICE)
    VALUES(CART_SEQ.NEXTVAL, 2,'USER1',59400);
    SELECT * FROM TBL_CART;
    DELETE TBL_CART WHERE ID=3;
    
    INSERT INTO TBL_ORDER(ID,C_ID,M_ID,PRICE)
    VALUES(ORDER_SEQ.NEXTVAL, 7,'USER1',35000);
    INSERT INTO TBL_ORDER(ID,C_ID,M_ID,PRICE)
    VALUES(ORDER_SEQ.NEXTVAL, 7,'USER2',35000);
    INSERT INTO TBL_ORDER(ID,C_ID,M_ID,PRICE)
    VALUES(ORDER_SEQ.NEXTVAL, 2,'USER1',59400);
    
    
    COMMIT;
SELECT * FROM TBL_ORDER;
SELECT * FROM TBL_CART;
SELECT * FROM TBL_REVIEW;
SELECT * FROM TBL_COURSE;
SELECT * FROM TBL_MEMBER;
SELECT * FROM TBL_CATEGORY;

UPDATE TBL_COURSE SET CONTENT ='초급자를 위해 준비한
[데이터 분석, 데이터 사이언스] 강의입니다.' WHERE ID=4;
UPDATE TBL_COURSE SET CONTENT ='오라클 성능 분석과 튜닝 핵심 가이드는 
여러분을 오라클(Oracle) 데이터베이스 전문 컨설턴트로 
빠르게 성장시키기 위한 핵심 가이드를 제공합니다.' WHERE ID=2;
UPDATE TBL_COURSE SET CONTENT ='쿠버네티스를 
정말 시작하는 단계에서 필요한 내용한 내용을 담았습니다. 
이 강의를 통해 쿠버네티스를 가장 손쉽게 구조를 이해하며 시작할 수 있습니다.' 
WHERE ID=7;
UPDATE TBL_COURSE SET CONTENT ='리눅스 커맨드라인 툴에 대한 강좌 입니다. 
자주 사용되는 툴을 엄선해 핵심 기능과 자주 사용되는 옵션에 대해 알려드립니다. 그리고 실습을 통해 실제로 어떻게 사용할 수 있는지 알려드립니다. 여러 가지 리눅스 툴을 잘 사용하게 된다면 리눅스가 편해집니다. 
그리고 리눅스를 더 잘 이해하고 더 잘 다루게 됩니다 :)' 
WHERE ID=8;
UPDATE TBL_COURSE SET CATEGORY2='server-dev'
WHERE ID=8;
UPDATE TBL_COURSE SET CATEGORY2='infra'
WHERE ID=7;